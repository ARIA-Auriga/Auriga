----------------------------------------
//1159 [2013/12/28] by Rayce

・@mannerpointの仕様をrAthena仕様に合わせる（clif.*, atcommand.c）
	-> msg_auriga.conf を使わずパケット 0x14a, 0x14b を利用する
	-> ポイントを0にすると SC_NOCHAT 状態を解除できる

・GMコマンド /rc が @mannerpoint として動作するように実装（clif.c）

・GMコマンド /remove は /shift と同じ動作として実装（clif.c）

・GMコマンド /check は clif_initialstatus() と同等の動作として実装（clif.c）

----------------------------------------
//1158 [2013/12/28] by Rayce

・[TXT] 永続マップ変数の保存のジャーナリング対応（mapreg_txt.*, journal.*）

・[SQL] 永続マップ変数の変更/削除があった場合、即座にMySQLサーバを更新するように変更（mapreg_sql.*）

  ※login系やchar系のセーブデータと同じ機構に合わせます。
	これにより自動セーブ待ち時点でサーバが落ちてもセーブデータが消失するような事故が無くなります。

・[SQL] スクリプト専用のMySQL接続が確立できていないときはクローズ処理も実施しないように修正（script.c）

・[SQL] SQLサーバとの接続をクローズするとき、どの接続のクローズなのか特定できるように拡張
        （sqldbs.*, account_sql.c, chardb_sql.c, mapreg_sql.c, script.c, converter.c）

・文字列型永続マップ変数をロードするとき、メモリリークが発生するバグを修正（mapreg_txt.c, mapreg_sql.c）

・文字列型変数で指定可能な値の最大バイト数の情報をドキュメント化（doc/script_ref.txt）

----------------------------------------
//1157 [2013/12/28] by Rayce

・mapreg_final() 時、解放済みの str_buf と str_data を参照してサーバクラッシュする
  問題を修正（script.c）
	reported by LunarPhantomさん

・userfunc_db を外部に公開せず、getter/setter を用意する（npc.c, script.*）

----------------------------------------
//1156 [2013/12/27] by Rayce

・Auriga-1155以降、config設定が読み込まれず mapreg_init() および mapreg_final() が
  呼び出されていない問題を修正（map.c, script.c）
	-> reported by LunarPhantomさん

・[SQL] MySQL接続時のcharsetのデフォルトを cp932 に変更

・[SQL] MySQLサーバ接続時にIP, Port, User, DB名の情報を表示するように変更（sqldbs.c）

----------------------------------------
//1155 [2013/12/26] by Rayce

・マップ変数のセーブ処理をTXTモードとSQLモードとでソースファイルを分離
  （map.c, script.*, mapreg_txt.*, mapreg_sql.*）

・conf/map_auriga.conf のうち、スクリプト専用のMySQLの設定項目を conf/script_auriga.conf に移動
  （map.*, script.c）

・MySQLへの接続は map.c ではなく mapreg_sql.c で行うように変更
  スクリプト専用のMySQLへの接続は script.c で行うように変更

・mapreg_txt.* および mapreg_sql.* をコンパイル対象に含める
  （Makefile, bcc32_make.bat, vc_make.bat, map.dsp, map_sql.dsp）

----------------------------------------
//1154 [2013/12/26] by Rayce

・コンパイルオプション /W4 有効時の警告修正
	-> warning C4189: 'xxx' : ローカル変数が初期化されましたが、参照されていません
	-> warning C4245: '=' : 'int' から 'unsigned int' に変換しました。signed/unsigned が一致しません。
	-> warning C4389: '!=' : signed と unsigned の数値を比較しようとしました。
	-> warning C4701: 初期化されていない可能性のあるローカル変数 'xxx' が使用されます
	-> warning C4702: 制御が渡らないコードです。

・イクシードブレイクの移動速度減少が、イクシードブレイクのスキルLvではなくフリーキャストのスキルLvを
  元に計算されていたのを修正（unit.c）

・ファイルのサイズを取得するとき、fseek, ftell を使わず stat を利用するように改善（httpd.c, grfio.c, map.c）

・map_mdmap_clean() のリファクタリング（map.c）

----------------------------------------
//1153 [2013/12/19] by refis

・ベナムフォグの回復処理のミスを修正（skill.c）

----------------------------------------
//1152 [2013/12/19] by refis

・NPCスキル「ベナムフォグ」実装（skill_cast_db.txt, skill_db2.txt, skill_db.txt, skill_unit_db.txt, skill.c）

・client_packet.txtの一部訂正（client_packet.txt）

・パケット0x8c7, 0x99fでウォーロックスキル「ラディウス」を参照していた箇所をユニット範囲に変更（clif.c）

----------------------------------------
//1151 [2013/12/07] by Rayce

・Auriga-1149で、clif_changelook() のパケット送出位置が間違っていたのを修正（clif.c）

・出来る限りWT系およびELE系定数を使用するように変更（battle.c, status.c）

----------------------------------------
//1150 [2013/12/07] by Rayce

・Auriga-0822以降、waitingroom命令の引数 job が正しく動作しなくなっていたのを修正（chat.c, pc.*, script.c）
	-> pc_check_useclass() を整理し、職業値のビットを返す関数 pc_get_job_bit() に変更。
	-> チャットの職業制限のビットは pc_get_job_bit() を参照するように変更。

・Auriga-0805以降、skill_require_db.txtの list_weapon 項目について、二刀流（93~98）の設定が
  無効になっていたのを修正（pc.c, skill.*, status.c）

・item_db.txtのSLOTの値が0~4以外の値の場合、バッファオーバー/アンダーフローが発生しないように
  読み込み時にチェックを入れる（itemdb.c）

・@optionの引数を16進数でも指定できるように拡張（atcommand.c）

・スクリプトにおいてクラスの番号指定をconst.txtの定数に変更（quest/npc_quest_arena.txt）

・helpおよびdb_refのメンテナンス（itemdb.c, conf/help.txt, doc/db_ref.txt）

・DBのヘッダ行のコメントの内容を正しく更新（db/size_fix.txt, db/skill_db2.txt）

----------------------------------------
//1149 [2013/12/07] by Rayce

・mob_talk() 実行するとき、最大値の判定を行うように強化（mob.c）

・pc_break_equip() の引数 where をunsinged short型からint型に拡張し、全てのLOC定数を受け入れることが
  可能にしておく（pc.*）

・map_session_data構造体の unbreakable_equip メンバをunsigned short型からunsinged int型に拡張し、
  全てのLOC定数でビット演算が可能にしておく（map.h）

・clif.cのリファクタリング、武器の見た目を取得する処理を clif_get_weapon_view() としてまとめる（clif.c）

・PACKETVERが3以下のとき、clif_changelook() でコンパイルエラーが発生する問題を修正（clif.c）

・装備箇所を示すLOC系定数をitemdb.hからmmo.hに移動し、char.cでも利用可能にする（mmo.h, itemdb.h）

・出来る限りenum型を使うように変更
  （chardb_txt.c, char.c, clif.c, extra.c, mob.c, pc.c, script.c, skill.c, status.c）

----------------------------------------
//1148 [2013/12/06] by Rayce

・関数名と意味を一致させるため pc_isquitable() の判定結果を反転（pc.c, clif.c）

・クライアントの切断パケット 0x18b を送る処理を clif_disconnect_ack() としてまとめる（clif.*）

・クライアントの終了判定で、エンジェラスの有無の判定方法をビット演算に変更（pc.c）

・INF系定数の名称を変更（battle.c, bonus.c, clif.c, mob.c, pet.c, script.c, skill.*, status.c, unit.c）

・INF2系定数を新たに設置（atcommand.c, battle.c, clif.c, pc.c, skill.*）

・LOOK系定数をmap.hからpc.hに移動（map.h, pc.h）

・出来る限りenum型を使うように変更（char.c, battle.c, mob.c, pc.c, status.c）

・status_change構造体で使用するopt1はビットフラグではないので、OPT1系のenum定数を16進数から
  10進数に変更する（status.h）

・clif_GMmessage() と clif_announce() のflag引数をunsigned int型に変更（clif.*）

----------------------------------------
//1147 [2013/12/06] by Rayce

・2進数対応の strtol, strtoul として strbtol, strbtoul を実装（utils.*）

・文字列を数値に変換するとき、2進数/8進数/16進数での変換をサポート（script.c, db/script_ref.txt）
	-> これまでは conv_num() が10進数固定だったのを基数を可変に変更。
	-> 例えば以下のような変換が可能。
		set '@val, "0b11" ⇒ 3
		set '@val, "077" ⇒ 63
		set '@val, "0xff" ⇒ 255

・@writevars や const.txt で2進数が扱えるように拡張（atcommand.c, script.c）

----------------------------------------
//1146 [2013/12/06] by Rayce

・べき乗演算子 ** を右結合に変更（script.c, doc/script_ref.txt）

  ※PerlやPythonと同じ仕様です。
    例えば、4 ** 3 ** 2 = 4096 ではなく 4 ** 3 ** 2 = 262144 となります。
    つまり、4 ** (3 ** 2) と等価になります。

・battle_configの etc_log と error_log について、スクリプトに関連する部分を
  script_configとして別途定義する（script.c）

  ※battle_config.etc_log   => script_config.debug_mode_log
    battle_config.error_log => script_config.error_log

・スクリプトのDEBUG用のメッセージを変更（script.c）

----------------------------------------
//1145 [2013/12/05] by refis

・装備ウィンドウの表示方法をデフォルトで誰でも利用可能にする（battle_auriga.conf）

・スクリプト関数「checkactiveitem」は活性状態を活性フラグで返すよう変更（script.c, doc/script_ref.txt）

・「審判のメイス」および「審判のメイスⅡ」スクリプトのアイテム活性効果を修正（db/item_db.txt）

----------------------------------------
//1144 [2013/12/05] by Rayce

・スクリプトにべき乗の演算子 ** を追加（script.c, doc/script_ref.txt）

  ※Perlライクな使い方になります。
    例] 2 ** 3 => 8 (2の3乗)

・const.txtに SC_SIGHT を定義し「クリムゾンオーブ」で使用する（db/const.txt, db/item_db.txt）

・「グロリアススピア」および「グロリアスランス」スクリプトの } 閉じ位置が
  間違っていたので修正（db/item_db.txt）

・「Kotakahuanaのガチャポン」の末尾にある不要な文字を削除（db/item_db.txt）

----------------------------------------
//1143 [2013/12/04] by Rayce

・出来る限りexternを止める
	-> ペット/傭兵/精霊のデータベースはインデックスではなくデータベースそのものを検索して
       返すように変更（atcommand.c, pet.*, merc.*, elem.*, npc.c, skill.c, status.c）

	-> quest_dbはそもそも公開していないのでexternを除去（quest.h）
	-> memorial_dataはそもそも公開していないのでexternを除去（memorial.h）

	-> スクリプトエラー判定用のコードをstaticに収める
       代わりに判定用の関数 script_is_error() を定義
       （elem.c, homun.c, itemdb.c, merc.c, npc.c, pet.c, script.*）

----------------------------------------
//1142 [2013/12/04] by Rayce

・gccでコンパイル時、msg.hでエラーが発生するのを修正（msg.h）

・gccでコンパイル時、「No sush file or directory」という警告が発生するのを修正（Makefile）

・status_get_race() で変数が未初期化の警告を修正（status.c）

・Linux環境で、SIGQUITを送る場合（CTRL+\）も終了処理できるように追加（core.c）

・[SQL] converterで配列のサイズが小さいためバッファオーバーフローが発生する問題を修正（char-converter.c）

----------------------------------------
//1141 [2013/12/04] by Rayce

・const.txt にサイズ系定数（Size_Small, Size_Medium, Size_Big）を追加（const.txt）

・item_db.txt のサイズ系ボーナスを定数に変更（db/item_db.txt, db/item_db_pre.txt）

・「グロリアススピア」のEquipScriptが動作していなかったのを修正（item_db.txt）
	reported by LunarPhantomさん

・item_db.txtの記述ミスを修正（item_db.txt）
	reported by LunarPhantomさん

・doc修正（item_bonus.txt, script_ref.txt）

----------------------------------------
//1140 [2013/12/04] by Rayce

・スクリプトの } 閉じの解析チェックを強化（script.*, elem.c, homun.c, itemdb.c, merc.c, npc.c, pet.c）
	-> npc_parse_script_line() を parse_script_line_curly() として script.c に共通化
	-> parse_script_line_curly() で curly_count が0になった時点でループを抜けるように改修
	-> parse_script() でも } で終わってない場合にエラー扱いにするように改修
	-> アイテム・ホム・傭兵・妖精のスクリプトの } 閉じチェックを共通化した
       parse_script_line_end() を新しく追加

・1行しかないスクリプトでエラーが発生したとき（missing right curlyなど）、表示されるエラー発生行が
  ズレる問題を修正（script.c）

・pet_db.txt および homun_db.txt の読込時、スクリプトエラーが発生すると読み込みカウントが増えない
  問題を修正（pet.c, homun.c）

・「missing right curly」が発生するアイテムスクリプトを修正（db/item_db.txt, db/item_db_pre.txt）

・スクリプト依存変数（'）を関数依存変数（'@）に変更（npc_town_hugel.txt）

----------------------------------------
//1139 [2013/12/03] by Rayce

・item 構造体と guild_member 構造体の並び順をpackに合わせて整理（mmo.h）
・mmo_status構造体の refuse_partyinvite と show_equip メンバをchar型に圧縮（mmo.h）

・merc_search_index() および elem_search_index() は -1 を返す可能性があるため、インデックスの
  値の判定を追加するように強化（status.c）

・0除算が発生する可能性を修正（bonus.c, pet.c, skill.c）

・pet_hungry() を pet_hungry_timer() にリネーム（pet.c）

----------------------------------------
//1138 [2013/12/03] by Rayce

・オートスペル、アクティブアイテム、bonus系命令の処理を pc.c から分離し、bonus.c に集約
  （bonus.*, battle.c, map.*, pc.*, script.c, skill.*）

・extraシステムを pc.c から分離し、extra.c に集約（extra.*, map.c, pc.c）

----------------------------------------
//1137 [2013/12/02] by Rayce

・Message Of The Day の処理を pc.c から msg.c に移管（atcommand.c, map.c, msg.*, pc.*）

----------------------------------------
//1136 [2013/12/02] by Rayce

・item_db.txtで使用するステータス異常の定数をconst.txtに追加（const.txt, db/item_db.txt）

・item_db.txtのスクリプトで関数が多重に呼び出されている部分を最適化
  （db/item_db.txt, db/pre/item_db_pre.txt）

----------------------------------------
//1135 [2013/12/02] by Rayce

・getbaseclass関数をscript.cからpc.cに移動（pc.*, script.c）

・以下のアイテムのオートスペル設定で、存在しない定数 EAS_ITEMNOCOST が記載されていたので削除
  （db/item_db.txt, db/pre/item_db_pre.txt）
	-> リングオブレゾナンス
	-> マグマフィスト
	-> アイシクルフィスト
	-> エレクトリックフィスト
	-> サイズミックフィスト
	-> 魔法のやかん

・以下のアイテムのボーナス設定で、存在しない定数 bAddFixCastRateAll が記載されていたので修正
  修正情報不明につきrAthenaから適当に移植（db/item_db.txt）
	-> おいしいロリポップR

・以下のアイテムのボーナス設定で、存在しない定数 bCritAtkRate が記載されていたので
  bAddCriticalDamage を使うように修正（db/item_db.txt）
	-> 虐殺のカタール(特攻)
	-> 戦慄のカタール

・以下のアイテムのボーナス設定で「Eff_Burning」のスペルミスを修正（db/item_db.txt）
	-> イグニスステイル
	-> バナスパティカード

・以下のアイテムのボーナス設定で「Eff_Silence」のスペルミスを修正（db/item_db.txt）
	-> カプラの猫耳ヘアバンド

・以下のアイテムのボーナス設定で「Rct_NonBoss」のスペルミスを修正（db/item_db.txt）
	-> サムライマスク

・以下のアイテムの状態異常設定で「SC_BLESSING」のスペルミスを修正（db/item_db.txt）
	-> 神妙な缶詰

・以下のアイテムで、非推奨の function_jobgroup.txt の関数を呼び出しているので修正
  修正情報不明につきrAthenaから適当に移植（db/item_db.txt）
	-> 3Dメガネ
	-> 3DメガネR

・以下のアイテムで、存在しない状態異常 SC_ELEMENTUNDEAD を SC_UndeadArmor に修正（db/item_db.txt）
	-> キュアーフリー

・以下のアイテムで不要な変数 n gが記載されていたので削除（db/item_db.txt, db/pre/item_db_pre.txt）
	-> ボーンヘッド

----------------------------------------
//1134 [2013/12/02] by Rayce

・pet_db.txt についても Auriga-1131 で const.txt に新しく定義した定数を使うように変更（db/pet_db.txt）

・アイテムボーナスの bRace のパラメータチェックの強化（pc.c, doc/item_bonus.txt）

・script_auriga.conf の refine_posword に余計な文字が混入していたのを修正（conf/script_auriga.conf）

・タイマーのtick変数には出来る限り unsigned を付与する（clif.*, map.h, pc.h, pet.c, skill.c）

----------------------------------------
//1133 [2013/12/02] by Rayce

・アイテムボーナス用の配列サイズのハードコーディングを避けるため定数を定義（map.h, pc.c）
	-> MAX_BONUS_CLASS: アイテムボーナスのクラスの容量
	-> MAX_BONUS_ADDDROP: アイテムボーナスのドロップの容量
	-> RCT_ALL: 全種族用

・bWeaponAtk と bWeaponAtkRate の配列は WT_MAX が最大なので、引数に指定できる数値を23までに制限する
  （doc/item_bonus.txt, battle.c, pc.c, status.c）

・item_db.txt について、Auriga-1131で const.txt に新しく定義した定数を使うように変更
  （db/item_db.txt, db/pre/item_db_pre.txt）

・item_db.txt の「サムライマスク」と「幸福の帽子」の bonus2命令の引数の使い方が間違っていたので修正（db/item_db.txt）

----------------------------------------
//1132 [2013/12/02] by Rayce

・Auriga-1130で更に size_t の型変換警告が出るのを修正（login.c, char.*, clif.c）
	reported by NP3228さん

----------------------------------------
//1131 [2013/12/02] by Rayce

・db/mob_group_db.txtのグループIDが MAX_MOBGROUP を越えるときは警告を表示し、スキップするように修正（mob.c）
	-> status_get_group() は補正せずに db/mob_group_db.txt のグループIDを返す。
       そのため敵グループ系のアイテムボーナス利用時に配列がバッファオーバーフローするため

・db/item_group_db.txtのグループIDが MAX_ITEMGROUP を越えるときは警告を表示し、スキップするように修正（itemdb.c）
	-> itemdb_group() は補正せずに db/item_group_db.txt のグループIDを返す。
       そのため bItemHealRate のアイテムボーナス利用時に配列がバッファオーバーフローするため

・装備関連のアイテムボーナス用の配列サイズが小さいので 11⇒EQUIP_INDEX_MAX まで拡張する（map.h）
	-> current_equip_item_index を使用するケースが該当する

・AddEff系アイテムボーナス用の配列サイズを MAX_SKILL_ADDEFF 定数で固定して整合性を取る（map.h, pc.c）

・MAX_SKILL_ADDEFF が状態異常の配列数なのか bAddEffSkill で登録できる容量なのか曖昧なので再定義（map.h, battle.c, pc.c, skill.c）
	-> MAX_EFF_TYPE: アイテムボーナスの状態異常の数
	-> MAX_SKILL_ADDEFF: bAddEffSkillで登録できる容量

・bBreakMyEquipWhenAttack と bBreakMyEquipWhenHit が bonus2 でも使えるように重複定義されていたので削除（pc.c）

・bLossEquipWhenHit の説明が無かったので追記（doc/item_bonus.txt）

・bonus系のパラメータチェックを強化（pc.c）

・db/const.txt に以下の定数を追加（db/const.txt）
	-> Rct系: 種族
	-> Ele系: 属性
	-> Emy系: 敵タイプ

----------------------------------------
//1130 [2013/12/01] by Rayce

・getequipname関数で引数に12以上で且つその部位の装備がない場合にバッファオーバーフローが
  発生するバグを修正（script.c, conf/script_auriga.conf）

・clif_disp_overhead() における型変換の警告を修正（clif.c）
	reported by NP3228さん

・メッセージ長を格納する変数は size_t型 に統一する
  （int_guild.c, int_party.c, inter.c, clif.*, guild.*, intif.*, party.*）

・1128のconst付与の抜け漏れ追加修正

----------------------------------------
//1129 [2013/12/01] by Rayce

・サーバースナップショット（version.h）

・0882で混入したwarpフォルダの削除
